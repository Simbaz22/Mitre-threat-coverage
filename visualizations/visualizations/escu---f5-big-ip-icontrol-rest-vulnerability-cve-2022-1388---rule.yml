title: ESCU - F5 BIG-IP iControl REST Vulnerability CVE-2022-1388 - Rule
description: The following analytic identifies a recent unauthenticated remote code
  execution vulnerablity against the F5 BIG-IP iControl REST API. The analytic identifies
  the URI path found in the POCs and the HTTP Method of POST. In addition, the request
  header will have the commands that may be executed in fields utilcmdargs and the
  auth field of X-F5-Auth-Token, which may have a random base64 encoded value.
status: Missing Data Source
author: DS
logsource:
  product: Splunk
  service: splunkd
  category: .nan
detection:
  condition:
    sigma: "\n  -  tstats count from datamodel=Web where Web.url=\"*/mgmt/tm/util/bash*\"\
      \ Web.http_method=\"POST\" by Web.http_user_agent Web.http_method, Web.url,Web.url_length\
      \ Web.src, Web.dest \n  -  `drop_dm_object_name(\"Web\")` \n  -  `security_content_ctime(firstTime)`\
      \ \n  -  `security_content_ctime(lastTime)` \n  -  `f5_big_ip_icontrol_rest_vulnerability_cve_2022_1388_filter`"
  level: critical
tags:
- T1190
- Exploit Public-Facing Application
- Initial Access
references: Requires F5 logs
notes: .nan
