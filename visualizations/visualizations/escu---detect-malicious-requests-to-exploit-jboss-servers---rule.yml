title: ESCU - Detect malicious requests to exploit JBoss servers - Rule
description: This search is used to detect malicious HTTP requests crafted to exploit
  jmx-console in JBoss servers. The malicious requests have a long URL length, as
  the payload is embedded in the URL.
status: Inactive
author: DS
logsource:
  product: Splunk
  service: splunkd
  category: Network
detection:
  condition:
    sigma: "\n  -  tstats `security_content_summariesonly` count min(_time) as firstTime\
      \ max(_time) as lastTime from datamodel=Web where (Web.http_method=\"GET\" OR\
      \ Web.http_method=\"HEAD\") by Web.http_method, Web.url,Web.url_length Web.src,\
      \ Web.dest \n  -  Web.url=\"*jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.admin*import*\"\
      \ AND Web.url_length > 200 \n  -  `drop_dm_object_name(\"Web\")` \n  -  `security_content_ctime(firstTime)`\
      \ \n  -  `security_content_ctime(lastTime)` \n  -  table src, dest_ip, http_method,\
      \ url, firstTime, lastTime \n  -  `detect_malicious_requests_to_exploit_jboss_servers_filter`"
  level: critical
tags:
- .nan
- .nan
- .nan
references: .nan
notes: Experimental detection (not supported by splunk)
